<!DOCTYPE html>
<html lang="en">
<title>Cat-Dog</title>
{% include 'html_head.html' %}
<!--<link rel="stylesheet" href="{{url_for('static', filename='model.css')}}" type="text/css">-->
<!--<script type="text/javascript" src="{{url_for('static', filename='model.js')}}"></script>-->
<link rel="stylesheet" href="/static/model.css" type="text/css">
<script type="text/javascript" src="/static/model.js"></script>
<body class="cog_body">

{% include 'navigation.html' %}

<!-- Flash Message -->
{% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
        {% for category, message in messages %}
            <div class="alert alert-{{ category }} message">
                {{ message }}
            </div>
        {% endfor %}
    {% endif %}
{% endwith %}
<!-------------->


<div id="problem_statement">

    <h2 style="color: #22D3EE;">I. Domain: </h2>
    <p>
        <b>Animal/Pets</b>.
    </p>

    <h2 style="color: #22D3EE;">II. Class: </h2>
    <p>
        <b>Supervised</b>.
    </p>

    <h2 style="color: #22D3EE;">III. Type: </h2>
    <p>
        <b>Classification (Binary)</b>.
    </p>

    <h2>1. Problem Statement: </h2>
    <p>
        We need to classify provided images of cats and dogs trained on images of cats and dogs.
    </p>

    <h2>2. Problem Type: </h2>
    <p>
        <b>Binary Classification</b>. There are 2 animal/pet species given namely:
    </p>
    <ul>
        <li><b><i>Cats.</i></b></li>
        <li><b><i>Dogs.</i></b></li>
    </ul>


    <h2>3. Dataset: </h2>
    <p>
        The dataset can be found on <a href="https://www.kaggle.com/c/dogs-vs-cats" target="_blank"><b style="color: #22D3EE;">Kaggle</b></a>.
        The <b>Training</b> dataset contains around <b>12000</b> images of cats and around <b>12000</b> images of dogs.
    </p>

    <h2>4. Tools/Libraries Used: </h2>
    <ul>
        <li>Programming Language Used:
            <ul>
                <li>Python 3.8</li>
                <li>HTML</li>
                <li>CSS</li>
                <li>Javascript</li>
            </ul>
        </li>
        <li>File Types Used:
            <ul>
                <li>.py</li>
                <li>.html</li>
                <li>.css</li>
                <li>.js</li>
                <li>.env</li>
                <li>.gitignore</li>
                <li>.gcloudignore</li>
                <li>.h5</li>
                <li>.conf</li>
                <li>.txt</li>
                <li>.log</li>
                <li>Dockerfile</li>
            </ul>
        </li>
        <li>Libraries Used:
            <ul>
                <li>tensorflow</li>
                <li>keras</li>
                <li>matplotlib</li>
                <li>numpy</li>
                <li>glob</li>
                <li>os</li>
                <li>shutil</li>
                <li>logging</li>
                <li>yaml</li>
                <li>flask</li>
                <li>wtforms</li>
                <li>dotenv</li>
            </ul>
        </li>
        <li>Tools Used:
            <ul>
                <li>Pycharm IDE</li>
                <li>Jupyter Notebook</li>
                <li>Docker</li>
                <li>Google Cloud Platform</li>
            </ul>
        </li>
    </ul>

    <h2>5. Steps taken to train the model: </h2>
    <ul><li>Create the CNN architecture. Here 2 kinds of architecture are used to train:
            <ul>
                <li>Simple Custom CNN <a href="/static/CatDog.svg" target="_blank" ><b style="color: #22D3EE;">architecture</b></a></li>
                <li>Transfer Learning using Resnet50 <a href="/static/CatDogResnet50.svg" target="_blank" ><b style="color: #22D3EE;">architecture</b></a></li>
            </ul>
        </li>
        <li>Load the images in the directory.</li>
        <li>Read the images via <b>Keras</b> with size of <b>256x256</b> for simple model and <b>224x224</b> for the resnet50 model.</li>
        <li>Split the images for the <b>Train Validation Split</b>.</li>
        <li>Construct the layers for the simple architecture or using transfer learning for the resnet50 architecture</li>
        <li><b>Fit</b> the model with the CNN architecture with <b>10</b> epochs and batch size of <b>32</b>.</li>
    </ul>
    <p><b style="color:red;">NOTE:</b>Even though the dataset contains altogether around <b>24000</b> images of cats and dogs.
        The training process actually has been done on around <b>6000</b> images of cats and around <b>6000</b> images of dogs for the both architecture, due to the limitation of hardware or processing power.
        As a result of these, the validation accuracy, with validation split as <b>0.2</b>, is around <b>74%</b> for the simple cnn model and around <b>97%</b> for the resnet50 model.
        So, the predicted result might show some discrepancies in accuracy or also might get wrong result.
        In case of transfer learning with ResNet50, the layers are not trained again, <b>imagenet</b> weights are been used.
    </p>
    <p><b style="color:red;">NOTE:</b>The number of epochs is chosen to be this small because of limitation of processing power.
        This took around 5 hours to train. Since the epochs are small, the <b>accuracy</b> is around <b>94.49%</b> for the simple model and <b>99.63%</b> for the resnet50 model.
    </p>

    <h2>6. Prediction: </h2>
    <p>
        The fitted and validated model has been used for <b>Prediction</b> of the test data.
    </p>

    <h2>7. Metrics Calculation: </h2>
    <p>
        Different classification metrics are used to check the efficiency of the validated model given the actual data:
    </p>
    <ul>
        <li><b>Accuracy Score</b>.</li>
        <li><b>Classification Report</b>.</li>
        <li><b>F1 Score</b>.</li>
        <li><b>Precision Score</b>.</li>
        <li><b>Recall Score</b>.</li>
        <li><b>Confusion Matrix</b>.</li>
    </ul>
    <h2>8. Notebook: </h2>
    <p>
        <a href="https://github.com/pritamsinha2304/Deep-Learning-Cat-Dog-Classifier" target="_blank"><b style="color: #22D3EE;">Link to .ipynb notebook</b></a>
    </p>
</div>

<div id="form_div">
    <h2>Upload Data</h2>
    <p style="font-family: 'Comfortaa', cursive; padding-left: 30px; color: #F87171"><b>* Use this form if you have your data available</b></p>
    <form method="post" enctype="multipart/form-data" id="form">
        {{ img_upload_form.hidden_tag() }}

        <h4>Upload the <b>test data</b> in <b>.jpg</b> format.</h4>
        <h4><b style="color: #F87171">* Required</b></h4>
        {{ img_upload_form.img_file }}
        {% for error in img_upload_form.img_file.errors %}
            <small class="text-danger">{{ error }}</small>
        {% endfor %}

        <h4>{{ img_upload_form.model.label }}</h4>
        <h4><b style="color: #F87171">* Required</b></h4>
        {{ img_upload_form.model }}
        {% for error in img_upload_form.model.errors %}
            <small class="text-danger">{{ error }}</small>
        {% endfor %}

        <h4>Upload the <b>actual data</b> in <b>.txt</b> or <b>.csv</b> format (if available).</h4>
        <h4><b style="color: #F87171">Format:</b> <b>Filename, Label</b></h4>
        <h4><b style="color: #22D3EE">Optional</b></h4>
        {{ img_upload_form.opt_file }}
        {% for error in img_upload_form.opt_file.errors %}
            <small class="text-danger">{{ error }}</small>
        {% endfor %}

        {{ img_upload_form.upload }}
        {% for error in img_upload_form.upload.errors %}
            <small class="text-danger">{{ error }}</small>
        {% endfor %}
    </form>
</div>

<div id="just_want_form_div">
    <h2>Demo Data</h2>
    <p style="font-family: 'Comfortaa', cursive; padding-left: 30px; color: #F87171"><b>* Use this form if you just want to see how it looks, and you don't have your data available.</b></p>
    <p style="font-family: 'Comfortaa', cursive; padding-left: 30px; color: #F87171">* The data used is just <b>Dummy Data</b> for testing.</p>
    <form method="post" enctype="multipart/form-data" id="form">
        {{ demo_form.csrf_token }}

        <h4>{{ demo_form.model_demo.label }}</h4>
        <h4><b style="color: #F87171">* Required</b></h4>
        {{ demo_form.model_demo }}
        {% for error in demo_form.model_demo.errors %}
            <small class="text-danger">{{ error }}</small>
        {% endfor %}

        {{ demo_form.upload_demo }}
        {% for error in demo_form.upload_demo.errors %}
            <small class="text-danger">{{ error }}</small>
        {% endfor %}

    </form>
</div>

</body>

</html>